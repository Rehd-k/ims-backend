'use strict';const a6_0x1fbd41=a6_0xbcfd;function a6_0xbcfd(_0x270b62,_0x248ba8){const _0x4440d5=a6_0x4440();return a6_0xbcfd=function(_0xbcfd79,_0x2d9d70){_0xbcfd79=_0xbcfd79-0x90;let _0x324aef=_0x4440d5[_0xbcfd79];return _0x324aef;},a6_0xbcfd(_0x270b62,_0x248ba8);}(function(_0x3ad7ba,_0x2bb170){const _0x236da9=a6_0xbcfd,_0x332928=_0x3ad7ba();while(!![]){try{const _0x2bc179=parseInt(_0x236da9(0xe7))/0x1*(-parseInt(_0x236da9(0xca))/0x2)+parseInt(_0x236da9(0x104))/0x3+parseInt(_0x236da9(0xcc))/0x4*(-parseInt(_0x236da9(0xef))/0x5)+parseInt(_0x236da9(0xab))/0x6*(-parseInt(_0x236da9(0xb1))/0x7)+-parseInt(_0x236da9(0x91))/0x8*(parseInt(_0x236da9(0xed))/0x9)+-parseInt(_0x236da9(0xf4))/0xa*(parseInt(_0x236da9(0xc2))/0xb)+parseInt(_0x236da9(0xd7))/0xc;if(_0x2bc179===_0x2bb170)break;else _0x332928['push'](_0x332928['shift']());}catch(_0x3040e1){_0x332928['push'](_0x332928['shift']());}}}(a6_0x4440,0x9665f));var __decorate=this&&this['__decorate']||function(_0x22cef0,_0x47cc7b,_0x41e089,_0x488665){const _0x204102=a6_0xbcfd;var _0x38b1ce=arguments[_0x204102(0xf3)],_0x4e19fc=_0x38b1ce<0x3?_0x47cc7b:_0x488665===null?_0x488665=Object[_0x204102(0xe9)](_0x47cc7b,_0x41e089):_0x488665,_0x3ed838;if(typeof Reflect==='object'&&typeof Reflect[_0x204102(0xe4)]==='function')_0x4e19fc=Reflect[_0x204102(0xe4)](_0x22cef0,_0x47cc7b,_0x41e089,_0x488665);else{for(var _0x18ed0a=_0x22cef0[_0x204102(0xf3)]-0x1;_0x18ed0a>=0x0;_0x18ed0a--)if(_0x3ed838=_0x22cef0[_0x18ed0a])_0x4e19fc=(_0x38b1ce<0x3?_0x3ed838(_0x4e19fc):_0x38b1ce>0x3?_0x3ed838(_0x47cc7b,_0x41e089,_0x4e19fc):_0x3ed838(_0x47cc7b,_0x41e089))||_0x4e19fc;}return _0x38b1ce>0x3&&_0x4e19fc&&Object[_0x204102(0xe1)](_0x47cc7b,_0x41e089,_0x4e19fc),_0x4e19fc;},__metadata=this&&this[a6_0x1fbd41(0xa1)]||function(_0x6acfa8,_0x590be8){const _0x4444e2=a6_0x1fbd41;if(typeof Reflect===_0x4444e2(0x92)&&typeof Reflect[_0x4444e2(0xae)]===_0x4444e2(0xf2))return Reflect[_0x4444e2(0xae)](_0x6acfa8,_0x590be8);},__param=this&&this['__param']||function(_0x3bf3b0,_0x4dd429){return function(_0x1a8591,_0x31271c){_0x4dd429(_0x1a8591,_0x31271c,_0x3bf3b0);};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a6_0x1fbd41(0xbf)]=void 0x0;const common_1=require(a6_0x1fbd41(0xce)),mongoose_1=require(a6_0x1fbd41(0xe0)),mongoose_2=require(a6_0x1fbd41(0xda)),customer_schema_1=require('../customer/customer.schema'),expenses_schema_1=require(a6_0x1fbd41(0xe2)),product_schema_1=require(a6_0x1fbd41(0xfc)),sales_schema_1=require(a6_0x1fbd41(0xb9));let AnalyticsService=class AnalyticsService{constructor(_0x267d51,_0x42c2ac,_0x3f7203,_0x586536){const _0x57f58c=a6_0x1fbd41;this[_0x57f58c(0xdc)]=_0x267d51,this[_0x57f58c(0xd4)]=_0x42c2ac,this[_0x57f58c(0xc3)]=_0x3f7203,this[_0x57f58c(0xaa)]=_0x586536;}async['getSalesDashboard'](_0x46430f){const _0xea2911=a6_0x1fbd41,_0x2dd1df=new Date();_0x2dd1df[_0xea2911(0xb3)](0x0,0x0,0x0,0x0);const _0x5c09f0=await this[_0xea2911(0xdc)]['aggregate']([{'$match':{'transactionDate':{'$gte':_0x2dd1df},'location':_0x46430f['user'][_0xea2911(0xd1)]}},{'$group':{'_id':null,'totalSales':{'$sum':'$totalAmount'}}}]),_0x20f89e=await this['saleModel'][_0xea2911(0xcf)]([{'$match':{'transactionDate':{'$gte':new Date(new Date()[_0xea2911(0x102)](new Date()[_0xea2911(0xbe)]()-0x7))},'location':_0x46430f['user'][_0xea2911(0xd1)]}},{'$group':{'_id':null,'totalSales':{'$sum':'$totalAmount'}}}]),_0x100d29=await this[_0xea2911(0xdc)][_0xea2911(0xcf)]([{'$match':{'transactionDate':{'$gte':new Date(new Date()[_0xea2911(0x102)](new Date()[_0xea2911(0xbe)]()-0x1e))},'location':_0x46430f[_0xea2911(0xeb)][_0xea2911(0xd1)]}},{'$group':{'_id':null,'totalSales':{'$sum':_0xea2911(0xc1)}}}]);return{'dailySales':_0x5c09f0[0x0]?.['totalSales']||0x0,'weeklySales':_0x20f89e[0x0]?.['totalSales']||0x0,'monthlySales':_0x100d29[0x0]?.[_0xea2911(0x98)]||0x0};}async['getRevenueReports'](_0xc25bcb){const _0x4daf0a=a6_0x1fbd41,_0x1753ac=await this[_0x4daf0a(0xdc)][_0x4daf0a(0xaf)]({'location':_0xc25bcb['user']['location']});let _0x5e5def=0x0,_0x361353=0x0;for(const _0x6ad6e of _0x1753ac){_0x5e5def+=_0x6ad6e['totalAmount'];for(const _0xc97556 of _0x6ad6e[_0x4daf0a(0xe8)]){const _0x1159d5=await this['productModel']['findById'](_0xc97556['_id']);_0x361353+=_0x1159d5[_0x4daf0a(0xf8)]*_0xc97556['quantity'];}}const _0x271e7e=_0x5e5def-_0x361353;return{'totalRevenue':_0x5e5def,'totalCost':_0x361353,'profit':_0x271e7e};}async[a6_0x1fbd41(0xd9)](_0x5596db){const _0x3c345f=a6_0x1fbd41,_0x1f8634=await this[_0x3c345f(0xd4)][_0x3c345f(0xaf)]({'location':_0x5596db[_0x3c345f(0xeb)]['location']}),_0xfcb7c3=_0x1f8634[_0x3c345f(0xd5)](_0x5d1259=>_0x5d1259[_0x3c345f(0xf7)]<_0x5d1259[_0x3c345f(0x90)]);return{'currentStock':_0x1f8634[_0x3c345f(0x93)](_0x1103fc=>({'name':_0x1103fc[_0x3c345f(0xbb)],'quantity':_0x1103fc[_0x3c345f(0xf7)]})),'lowStock':_0xfcb7c3,'stockTurnoverRates':_0x1f8634['map'](_0x1eed30=>({'name':_0x1eed30[_0x3c345f(0xbb)],'turnoverRate':(_0x1eed30['sold']||0x0)/(_0x1eed30[_0x3c345f(0xf7)]+(_0x1eed30[_0x3c345f(0xf6)]||0x0))}))};}async[a6_0x1fbd41(0x9f)](_0x1066e5){const _0x38b074=a6_0x1fbd41,_0x44f6e2=new Date();_0x44f6e2['setHours'](0x0,0x0,0x0,0x0);const _0x494d76=await this['saleModel'][_0x38b074(0xcf)]([{'$match':{'transactionDate':{'$gte':_0x44f6e2},'location':_0x1066e5[_0x38b074(0xeb)][_0x38b074(0xd1)]}},{'$unwind':_0x38b074(0xea)},{'$group':{'_id':{'$toObjectId':_0x38b074(0xe3)},'totalSold':{'$sum':_0x38b074(0xad)}}},{'$sort':{'totalSold':-0x1}},{'$limit':0x5},{'$lookup':{'from':_0x38b074(0xe8),'localField':_0x38b074(0x9e),'foreignField':_0x38b074(0x9e),'as':_0x38b074(0xcb)}},{'$unwind':_0x38b074(0x101)},{'$project':{'_id':0x0,'title':'$productDetails.title','totalSold':0x1}}]),_0x28d681=await this['saleModel']['aggregate']([{'$match':{'transactionDate':{'$gte':new Date(new Date()[_0x38b074(0x102)](new Date()[_0x38b074(0xbe)]()-0x7))},'location':_0x1066e5['user']['location']}},{'$unwind':'$products'},{'$group':{'_id':{'$toObjectId':_0x38b074(0xe3)},'totalSold':{'$sum':_0x38b074(0xad)}}},{'$sort':{'totalSold':-0x1}},{'$limit':0x5},{'$lookup':{'from':_0x38b074(0xe8),'localField':_0x38b074(0x9e),'foreignField':'_id','as':_0x38b074(0xa6)}},{'$unwind':_0x38b074(0xe6)},{'$project':{'_id':0x0,'title':_0x38b074(0xd2),'totalSold':0x1}}]),_0x19201d=await this[_0x38b074(0xdc)]['aggregate']([{'$match':{'transactionDate':{'$gte':new Date(new Date()['setDate'](new Date()[_0x38b074(0xbe)]()-0x1e))},'location':_0x1066e5[_0x38b074(0xeb)][_0x38b074(0xd1)]}},{'$unwind':_0x38b074(0xea)},{'$group':{'_id':{'$toObjectId':_0x38b074(0xe3)},'totalSold':{'$sum':'$products.quantity'}}},{'$sort':{'totalSold':-0x1}},{'$limit':0x5},{'$lookup':{'from':_0x38b074(0xe8),'localField':_0x38b074(0x9e),'foreignField':_0x38b074(0x9e),'as':_0x38b074(0xa6)}},{'$unwind':_0x38b074(0xe6)},{'$project':{'_id':0x0,'title':'$product.title','totalSold':0x1}}]);return{'topSellingToday':_0x494d76,'topSellingWeekly':_0x28d681,'topSellingMonthly':_0x19201d};}async[a6_0x1fbd41(0x97)](_0x5250a5,_0x11414c){const _0x4cfbd9=a6_0x1fbd41,_0x4b2e26=new Date(_0x5250a5[_0x4cfbd9(0xcd)]);_0x4b2e26[_0x4cfbd9(0xb3)](0x0,0x0,0x0,0x0);const _0x54ce5b=new Date(_0x5250a5[_0x4cfbd9(0xa8)]);_0x54ce5b[_0x4cfbd9(0xb3)](0x17,0x3b,0x3b,0x3e7);const _0x2cca63=await this['saleModel'][_0x4cfbd9(0xcf)]([{'$match':{'transactionDate':{'$gte':_0x4b2e26,'$lte':_0x54ce5b},'location':_0x11414c[_0x4cfbd9(0xeb)]['location']}},{'$group':{'_id':null,'totalRevenue':{'$sum':_0x4cfbd9(0xc1)}}}]),_0x42bb12=_0x2cca63[0x0]?.[_0x4cfbd9(0xa3)]||0x0,_0x5cec65=await this['expenseModel'][_0x4cfbd9(0xcf)]([{'$match':{'createdAt':{'$gte':_0x4b2e26,'$lte':_0x54ce5b},'location':_0x11414c[_0x4cfbd9(0xeb)][_0x4cfbd9(0xd1)]}},{'$group':{'_id':null,'totalExpenses':{'$sum':_0x4cfbd9(0xb4)}}}]),_0x31fb61=_0x5cec65[0x0]?.['totalExpenses']||0x0,_0xc7425b=_0x42bb12-_0x31fb61;return{'totalRevenue':_0x42bb12,'totalExpenses':_0x31fb61,'profitOrLoss':_0xc7425b};}async[a6_0x1fbd41(0xd6)](_0x1e8a92){const _0x223040=a6_0x1fbd41,_0x3a70ec=await this[_0x223040(0xd4)][_0x223040(0xcf)]([{'$match':{'isAvailable':!![],'location':_0x1e8a92[_0x223040(0xeb)][_0x223040(0xd1)]}},{'$facet':{'totalProducts':[{'$count':'count'}],'totalQuantity':[{'$group':{'_id':null,'totalQuantity':{'$sum':'$quantity'}}}],'totalValue':[{'$group':{'_id':null,'totalValue':{'$sum':{'$multiply':[_0x223040(0xfe),_0x223040(0xac)]}}}}],'lowStockCount':[{'$match':{'$expr':{'$lt':['$quantity',_0x223040(0xb5)]}}},{'$count':_0x223040(0xa9)}],'fastestMovingProduct':[{'$sort':{'sold':-0x1}},{'$limit':0x1},{'$project':{'_id':0x1,'title':0x1}}],'slowestMovingProduct':[{'$sort':{'sold':0x1}},{'$limit':0x1},{'$project':{'_id':0x1,'title':0x1}}],'expiredProducts':[{'$match':{'expiryDate':{'$lt':new Date()}}},{'$count':'count'}]}},{'$project':{'totalProducts':{'$arrayElemAt':[_0x223040(0xdf),0x0]},'totalQuantity':{'$arrayElemAt':['$totalQuantity.totalQuantity',0x0]},'totalValue':{'$arrayElemAt':[_0x223040(0xfa),0x0]},'lowStockCount':{'$arrayElemAt':[_0x223040(0xfb),0x0]},'fastestMovingProduct':{'$arrayElemAt':['$fastestMovingProduct',0x0]},'slowestMovingProduct':{'$arrayElemAt':[_0x223040(0xfd),0x0]},'expiredProducts':{'$arrayElemAt':[_0x223040(0xc4),0x0]}}}]);return _0x3a70ec[0x0];}async[a6_0x1fbd41(0x99)](_0x39f44e){const _0x4a80cf=a6_0x1fbd41,_0x599c35=await this[_0x4a80cf(0xaa)][_0x4a80cf(0xcf)]([{'$match':{'location':_0x39f44e[_0x4a80cf(0xeb)][_0x4a80cf(0xd1)]}},{'$lookup':{'from':'sales','localField':_0x4a80cf(0xf1),'foreignField':_0x4a80cf(0x9e),'as':_0x4a80cf(0xa4)}},{'$lookup':{'from':_0x4a80cf(0xff),'localField':_0x4a80cf(0xde),'foreignField':_0x4a80cf(0x9e),'as':'returnDetails'}},{'$addFields':{'lastPurchase':{'$arrayElemAt':[{'$slice':[_0x4a80cf(0xb0),-0x1]},0x0]},'orderCount':{'$size':'$orders'}}},{'$facet':{'newestCustomers':[{'$sort':{'createdAt':-0x1}},{'$limit':0x4},{'$project':{'_id':0x1,'name':0x1,'lastPurchaseDate':_0x4a80cf(0xb6),'lastPurchaseAmount':_0x4a80cf(0xc0),'total_spent':0x1}}],'mostFrequentCustomer':[{'$sort':{'orderCount':-0x1}},{'$limit':0x4},{'$project':{'_id':0x1,'name':0x1,'lastPurchaseDate':_0x4a80cf(0xb6),'lastPurchaseAmount':'$lastPurchase.totalAmount','total_spent':0x1}}],'totalCustomers':[{'$count':_0x4a80cf(0x9a)}],'retentionCurrentMonth':[{'$match':{'lastPurchase.transactionDate':{'$gte':new Date(new Date()[_0x4a80cf(0x102)](0x1)),'$lt':new Date()}}},{'$count':_0x4a80cf(0xf5)}]}}]);return _0x599c35[0x0];}async[a6_0x1fbd41(0x96)](_0x374fd3){const _0x59c2f8=a6_0x1fbd41,_0x306487=new Date();_0x306487[_0x59c2f8(0x102)](_0x306487['getDate']()-_0x306487[_0x59c2f8(0x9d)]()),_0x306487['setHours'](0x0,0x0,0x0,0x0);const _0x3537dc=new Date(_0x306487);_0x3537dc[_0x59c2f8(0x102)](_0x3537dc['getDate']()+0x6),_0x3537dc[_0x59c2f8(0xb3)](0x17,0x3b,0x3b,0x3e7);const _0x3e38d9=await this[_0x59c2f8(0xdc)][_0x59c2f8(0xcf)]([{'$match':{'transactionDate':{'$gte':_0x306487,'$lte':_0x3537dc},'location':_0x374fd3[_0x59c2f8(0xeb)][_0x59c2f8(0xd1)]}},{'$group':{'_id':{'$dateToString':{'format':_0x59c2f8(0xc7),'date':'$transactionDate'}},'totalSales':{'$sum':_0x59c2f8(0xc1)}}},{'$sort':{'_id':0x1}}]),_0x397283=await this[_0x59c2f8(0xc3)][_0x59c2f8(0xcf)]([{'$match':{'createdAt':{'$gte':_0x306487,'$lte':_0x3537dc},'location':_0x374fd3[_0x59c2f8(0xeb)][_0x59c2f8(0xd1)]}},{'$group':{'_id':{'$dateToString':{'format':'%Y-%m-%d','date':_0x59c2f8(0xba)}},'totalExpenses':{'$sum':_0x59c2f8(0xb4)}}},{'$sort':{'_id':0x1}}]),_0x47ef15=['Sun',_0x59c2f8(0xa0),'Tue',_0x59c2f8(0xd3),_0x59c2f8(0xb2),_0x59c2f8(0xa2),_0x59c2f8(0xd0)],_0x29c54d=new Map(_0x397283['map'](_0x220d44=>[_0x220d44[_0x59c2f8(0x9e)],_0x220d44[_0x59c2f8(0xc8)]])),_0x43718d=new Set([..._0x3e38d9[_0x59c2f8(0x93)](_0x1e23d7=>_0x1e23d7[_0x59c2f8(0x9e)]),..._0x397283[_0x59c2f8(0x93)](_0x433660=>_0x433660['_id'])]),_0x540ce8=Array[_0x59c2f8(0x9b)](_0x43718d)[_0x59c2f8(0x93)](_0x485425=>{const _0x2f8fe2=_0x59c2f8,_0xed3917=_0x3e38d9[_0x2f8fe2(0xaf)](_0x5539ac=>_0x5539ac[_0x2f8fe2(0x9e)]===_0x485425)||{'totalSales':0x0},_0x570f9c=_0x397283[_0x2f8fe2(0xaf)](_0x412ec4=>_0x412ec4[_0x2f8fe2(0x9e)]===_0x485425)||{'totalExpenses':0x0},_0x59e224=_0x47ef15[new Date(_0x485425)[_0x2f8fe2(0x9d)]()];return{'date':_0x485425,'totalSales':_0xed3917[_0x2f8fe2(0x98)],'expenses':_0x570f9c['totalExpenses'],'day':_0x59e224};});return _0x540ce8['sort']((_0x4c8fb8,_0x5a886e)=>new Date(_0x4c8fb8[_0x59c2f8(0xdd)])['getTime']()-new Date(_0x5a886e[_0x59c2f8(0xdd)])[_0x59c2f8(0xf0)]());}async[a6_0x1fbd41(0x103)](_0x1b965c,_0x22ef5a){const _0x597c02=a6_0x1fbd41,_0x283a30=new Date();let _0x916115,_0x2ff5fd,_0x4b2c9b;switch(_0x1b965c){case _0x597c02(0xc6):_0x916115=new Date(_0x283a30[_0x597c02(0xb3)](0x0,0x0,0x0,0x0)),_0x2ff5fd=new Date(_0x283a30['setHours'](0x17,0x3b,0x3b,0x3e7)),_0x4b2c9b={'for':{'$add':[{'$divide':[{'$subtract':[{'$hour':_0x597c02(0xb8)},{'$mod':[{'$hour':_0x597c02(0xb8)},0x2]}]},0x2]},0x1]}};break;case'This\x20Week':_0x916115=new Date(_0x283a30['setDate'](_0x283a30[_0x597c02(0xbe)]()-_0x283a30[_0x597c02(0x9d)]())),_0x2ff5fd=new Date(_0x283a30[_0x597c02(0x102)](_0x283a30[_0x597c02(0xbe)]()-_0x283a30[_0x597c02(0x9d)]()+0x6)),_0x4b2c9b={'for':{'$dayOfWeek':_0x597c02(0xb8)}};break;case _0x597c02(0x9c):_0x916115=new Date(),_0x916115[_0x597c02(0x102)](_0x916115[_0x597c02(0xbe)]()-0x6),_0x916115[_0x597c02(0xb3)](0x0,0x0,0x0,0x0),_0x2ff5fd=new Date(),_0x2ff5fd[_0x597c02(0xb3)](0x17,0x3b,0x3b,0x3e7),_0x4b2c9b={'for':{'$subtract':[{'$add':[{'$dateDiff':{'startDate':_0x916115,'endDate':_0x597c02(0xb8),'unit':_0x597c02(0xbc)}},0x1]},0x1]}};break;case _0x597c02(0x95):_0x916115=new Date(_0x283a30[_0x597c02(0x102)](_0x283a30['getDate']()-_0x283a30[_0x597c02(0x9d)]()-0x7)),_0x2ff5fd=new Date(_0x283a30[_0x597c02(0x102)](_0x283a30[_0x597c02(0xbe)]()-_0x283a30[_0x597c02(0x9d)]()-0x1)),_0x4b2c9b={'for':{'$dayOfWeek':_0x597c02(0xb8)}};break;case _0x597c02(0xe5):_0x916115=new Date(_0x283a30[_0x597c02(0xec)](),_0x283a30[_0x597c02(0xd8)](),0x1),_0x2ff5fd=new Date(_0x283a30[_0x597c02(0xec)](),_0x283a30[_0x597c02(0xd8)]()+0x1,0x0),_0x4b2c9b={'for':{'$dayOfMonth':_0x597c02(0xb8)}};break;case _0x597c02(0x105):_0x916115=new Date(_0x283a30[_0x597c02(0xec)](),_0x283a30['getMonth']()-0x1,0x1),_0x2ff5fd=new Date(_0x283a30[_0x597c02(0xec)](),_0x283a30[_0x597c02(0xd8)](),0x0),_0x4b2c9b={'for':{'$dayOfMonth':'$transactionDate'}};break;case _0x597c02(0xdb):_0x916115=new Date(_0x283a30[_0x597c02(0xec)](),0x0,0x1),_0x2ff5fd=new Date(_0x283a30[_0x597c02(0xec)](),0x3,0x0),_0x4b2c9b={'for':{'$month':_0x597c02(0xb8)}};break;case _0x597c02(0xc9):_0x916115=new Date(_0x283a30[_0x597c02(0xec)](),0x3,0x1),_0x2ff5fd=new Date(_0x283a30[_0x597c02(0xec)](),0x6,0x0),_0x4b2c9b={'for':{'$month':_0x597c02(0xb8)}};break;case'Third\x20Quarter':_0x916115=new Date(_0x283a30[_0x597c02(0xec)](),0x6,0x1),_0x2ff5fd=new Date(_0x283a30[_0x597c02(0xec)](),0x9,0x0),_0x4b2c9b={'for':{'$month':_0x597c02(0xb8)}};break;case _0x597c02(0xbd):_0x916115=new Date(_0x283a30[_0x597c02(0xec)](),0x9,0x1),_0x2ff5fd=new Date(_0x283a30[_0x597c02(0xec)](),0xc,0x0),_0x4b2c9b={'for':{'$month':_0x597c02(0xb8)}};break;case'This\x20Year':_0x916115=new Date(_0x283a30[_0x597c02(0xec)](),0x0,0x1),_0x2ff5fd=new Date(_0x283a30[_0x597c02(0xec)](),0xb,0x1f),_0x4b2c9b={'for':{'$month':_0x597c02(0xb8)}};break;default:throw new Error('Invalid\x20option');}const _0x52d2f2=await this[_0x597c02(0xdc)][_0x597c02(0xcf)]([{'$match':{'transactionDate':{'$gte':_0x916115,'$lte':_0x2ff5fd},'location':_0x22ef5a['user'][_0x597c02(0xd1)]}},{'$group':{'_id':_0x4b2c9b,'totalSales':{'$sum':_0x597c02(0xc1)}}},{'$sort':{'_id':0x1}},{'$project':{'_id':0x0,'for':'$_id.for','totalSales':0x1}}]);return _0x52d2f2;}};function a6_0x4440(){const _0x5a5b79=['design:paramtypes','582915zpPRzh','getTime','orders','function','length','4756310ELKXzB','customerRetention','sold','quantity','purchasePrice','Sale','$totalValue.totalValue','$lowStockCount.count','../product/product.schema','$slowestMovingProduct','$quantity','sales','Product','$productDetails','setDate','getSalesData','1501614aoIpdo','Last\x20Month','roq','312184UhiGXm','object','map','Injectable','Last\x20Week','getWeeklySalesData','getProfitAndLoss','totalSales','getCustomerStatistics','totalCustomers','from','Last\x207\x20Days','getDay','_id','getTopSellingProducts','Mon','__metadata','Fri','totalRevenue','orderDetails','Model','product','Expenses','endDate','count','customerModel','287484NJjxok','$price','$products.quantity','metadata','find','$orderDetails','133cgMzTc','Thu','setHours','$amount','$roq','$lastPurchase.transactionDate','InjectModel','$transactionDate','../sales/sales.schema','$createdAt','title','day','Fourth\x20Quarter','getDate','AnalyticsService','$lastPurchase.totalAmount','$totalAmount','11FiSJuk','expenseModel','$expiredProducts.count','name','Today','%Y-%m-%d','totalExpenses','Second\x20Quarter','1116426VsmvsX','productDetails','16zXPtxh','startDate','@nestjs/common','aggregate','Sat','location','$product.title','Wed','productModel','filter','getProductStatistics','44035116nBYtbw','getMonth','getInventoryReports','mongoose','First\x20Quarter','saleModel','date','returns','$totalProducts.count','@nestjs/mongoose','defineProperty','../expense/expenses.schema','$products._id','decorate','This\x20Month','$product','2JvVhRw','products','getOwnPropertyDescriptor','$products','user','getFullYear','135AtORKB'];a6_0x4440=function(){return _0x5a5b79;};return a6_0x4440();}exports[a6_0x1fbd41(0xbf)]=AnalyticsService,exports['AnalyticsService']=AnalyticsService=__decorate([(0x0,common_1[a6_0x1fbd41(0x94)])(),__param(0x0,(0x0,mongoose_1[a6_0x1fbd41(0xb7)])(sales_schema_1[a6_0x1fbd41(0xf9)][a6_0x1fbd41(0xc5)])),__param(0x1,(0x0,mongoose_1[a6_0x1fbd41(0xb7)])(product_schema_1[a6_0x1fbd41(0x100)]['name'])),__param(0x2,(0x0,mongoose_1[a6_0x1fbd41(0xb7)])(expenses_schema_1[a6_0x1fbd41(0xa7)][a6_0x1fbd41(0xc5)])),__param(0x3,(0x0,mongoose_1[a6_0x1fbd41(0xb7)])(customer_schema_1['Customer'][a6_0x1fbd41(0xc5)])),__metadata(a6_0x1fbd41(0xee),[mongoose_2[a6_0x1fbd41(0xa5)],mongoose_2[a6_0x1fbd41(0xa5)],mongoose_2[a6_0x1fbd41(0xa5)],mongoose_2[a6_0x1fbd41(0xa5)]])],AnalyticsService);