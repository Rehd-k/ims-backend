'use strict';const a6_0x5e3c3e=a6_0x14a6;(function(_0x3ce266,_0x65f65b){const _0x29f1be=a6_0x14a6,_0x1a1cf0=_0x3ce266();while(!![]){try{const _0x32fada=parseInt(_0x29f1be(0x10c))/0x1+parseInt(_0x29f1be(0x132))/0x2+parseInt(_0x29f1be(0x13a))/0x3+-parseInt(_0x29f1be(0x109))/0x4*(-parseInt(_0x29f1be(0x14c))/0x5)+-parseInt(_0x29f1be(0x16e))/0x6*(parseInt(_0x29f1be(0x123))/0x7)+parseInt(_0x29f1be(0x153))/0x8*(-parseInt(_0x29f1be(0x162))/0x9)+-parseInt(_0x29f1be(0x166))/0xa;if(_0x32fada===_0x65f65b)break;else _0x1a1cf0['push'](_0x1a1cf0['shift']());}catch(_0x1e7ea5){_0x1a1cf0['push'](_0x1a1cf0['shift']());}}}(a6_0x4ef0,0xb30bd));var __decorate=this&&this['__decorate']||function(_0x5ae795,_0x4492e8,_0x4d71c7,_0xeeea28){const _0x4d1787=a6_0x14a6;var _0x1898b3=arguments[_0x4d1787(0x12e)],_0x329371=_0x1898b3<0x3?_0x4492e8:_0xeeea28===null?_0xeeea28=Object[_0x4d1787(0x135)](_0x4492e8,_0x4d71c7):_0xeeea28,_0x5a3e5e;if(typeof Reflect===_0x4d1787(0x117)&&typeof Reflect[_0x4d1787(0x10e)]==='function')_0x329371=Reflect['decorate'](_0x5ae795,_0x4492e8,_0x4d71c7,_0xeeea28);else{for(var _0x9d4150=_0x5ae795['length']-0x1;_0x9d4150>=0x0;_0x9d4150--)if(_0x5a3e5e=_0x5ae795[_0x9d4150])_0x329371=(_0x1898b3<0x3?_0x5a3e5e(_0x329371):_0x1898b3>0x3?_0x5a3e5e(_0x4492e8,_0x4d71c7,_0x329371):_0x5a3e5e(_0x4492e8,_0x4d71c7))||_0x329371;}return _0x1898b3>0x3&&_0x329371&&Object[_0x4d1787(0x13c)](_0x4492e8,_0x4d71c7,_0x329371),_0x329371;},__metadata=this&&this[a6_0x5e3c3e(0x127)]||function(_0x4374e4,_0xf2d13){const _0x3215b1=a6_0x5e3c3e;if(typeof Reflect===_0x3215b1(0x117)&&typeof Reflect[_0x3215b1(0x16b)]===_0x3215b1(0x14f))return Reflect['metadata'](_0x4374e4,_0xf2d13);},__param=this&&this['__param']||function(_0x4c2416,_0x30d7a6){return function(_0xeb7dd,_0x38884e){_0x30d7a6(_0xeb7dd,_0x38884e,_0x4c2416);};};Object[a6_0x5e3c3e(0x13c)](exports,'__esModule',{'value':!![]}),exports[a6_0x5e3c3e(0x138)]=void 0x0;const common_1=require(a6_0x5e3c3e(0x115)),mongoose_1=require(a6_0x5e3c3e(0x154)),mongoose_2=require('mongoose'),customer_schema_1=require(a6_0x5e3c3e(0x10a)),expenses_schema_1=require('../expense/expenses.schema'),product_schema_1=require(a6_0x5e3c3e(0x122)),sales_schema_1=require('../sales/sales.schema');function a6_0x14a6(_0x5d1333,_0x3de2a1){const _0x4ef013=a6_0x4ef0();return a6_0x14a6=function(_0x14a685,_0x21a7be){_0x14a685=_0x14a685-0x106;let _0x167ffc=_0x4ef013[_0x14a685];return _0x167ffc;},a6_0x14a6(_0x5d1333,_0x3de2a1);}function a6_0x4ef0(){const _0x3a452b=['$lastPurchase.totalAmount','$products.quantity','date','Expenses','sort','count','@nestjs/common','Fri','object','$roq','$expiredProducts.count','Third\x20Quarter','Invalid\x20option','returnDetails','Injectable','SZNgT','$createdAt','orders','getWeeklySalesData','../product/product.schema','70kRlUuH','setHours','setDate','$product','__metadata','expenseModel','QeGDu','getFullYear','VdbCp','InjectModel','products','length','getDate','filter','cRbcL','2297150ofVopH','OfWxj','$products._id','getOwnPropertyDescriptor','Sat','returns','AnalyticsService','sold','2051958uBqVCn','_id','defineProperty','purchasePrice','$amount','totalCustomers','getProfitAndLoss','PpbiQ','xKKIo','aggregate','productDetails','Sun','location','gWOoI','$products','This\x20Month','find','XyZIJ','10TYCvSk','Model','CbzLY','function','$transactionDate','getInventoryReports','This\x20Week','31544fWMtzw','@nestjs/mongoose','$product.title','customerRetention','totalExpenses','quantity','First\x20Quarter','rSzDx','$totalQuantity.totalQuantity','title','EExPS','productModel','getDay','name','getTopSellingProducts','3231ZjOXtY','vGnRQ','$lowStockCount.count','saleModel','7201320fOsGLp','sales','getSalesData','blMGv','Thu','metadata','endDate','yTteY','775290QUNwCY','map','dBBoN','product','$totalAmount','customerModel','qWvkA','$quantity','user','1750916HIQlSx','../customer/customer.schema','Last\x20Week','1453173SASrmM','totalSales','decorate'];a6_0x4ef0=function(){return _0x3a452b;};return a6_0x4ef0();}let AnalyticsService=class AnalyticsService{constructor(_0x20d012,_0x419d6b,_0x330b1a,_0x39470b){const _0x28b355=a6_0x5e3c3e;this['saleModel']=_0x20d012,this['productModel']=_0x419d6b,this[_0x28b355(0x128)]=_0x330b1a,this['customerModel']=_0x39470b;}async['getSalesDashboard'](_0x433294){const _0x210b9b=a6_0x5e3c3e,_0x4b4705={'qWvkA':function(_0x4ba6b0,_0x22dccd){return _0x4ba6b0-_0x22dccd;},'xKKIo':'$totalAmount'},_0x30697d=new Date();_0x30697d['setHours'](0x0,0x0,0x0,0x0);const _0x27cdf8=await this['saleModel'][_0x210b9b(0x143)]([{'$match':{'transactionDate':{'$gte':_0x30697d},'location':_0x433294['user'][_0x210b9b(0x146)]}},{'$group':{'_id':null,'totalSales':{'$sum':'$totalAmount'}}}]),_0xcb0791=await this[_0x210b9b(0x165)]['aggregate']([{'$match':{'transactionDate':{'$gte':new Date(new Date()[_0x210b9b(0x125)](_0x4b4705[_0x210b9b(0x106)](new Date()[_0x210b9b(0x12f)](),0x7)))},'location':_0x433294['user']['location']}},{'$group':{'_id':null,'totalSales':{'$sum':_0x4b4705['xKKIo']}}}]),_0x522a96=await this[_0x210b9b(0x165)]['aggregate']([{'$match':{'transactionDate':{'$gte':new Date(new Date()[_0x210b9b(0x125)](new Date()['getDate']()-0x1e))},'location':_0x433294['user']['location']}},{'$group':{'_id':null,'totalSales':{'$sum':_0x4b4705[_0x210b9b(0x142)]}}}]);return{'dailySales':_0x27cdf8[0x0]?.['totalSales']||0x0,'weeklySales':_0xcb0791[0x0]?.[_0x210b9b(0x10d)]||0x0,'monthlySales':_0x522a96[0x0]?.['totalSales']||0x0};}async['getRevenueReports'](_0x21ab6f){const _0x154618=a6_0x5e3c3e,_0x70cb0={'gWOoI':function(_0x43c958,_0x1efb37){return _0x43c958-_0x1efb37;}},_0x3f71bd=await this['saleModel']['find']({'location':_0x21ab6f[_0x154618(0x108)][_0x154618(0x146)]});let _0x414c12=0x0,_0x5cb682=0x0;for(const _0x2e2c29 of _0x3f71bd){_0x414c12+=_0x2e2c29['totalAmount'];for(const _0x1e2ed4 of _0x2e2c29[_0x154618(0x12d)]){const _0x1ea02b=await this[_0x154618(0x15e)]['findById'](_0x1e2ed4[_0x154618(0x13b)]);_0x5cb682+=_0x1ea02b[_0x154618(0x13d)]*_0x1e2ed4[_0x154618(0x158)];}}const _0x516df2=_0x70cb0[_0x154618(0x147)](_0x414c12,_0x5cb682);return{'totalRevenue':_0x414c12,'totalCost':_0x5cb682,'profit':_0x516df2};}async[a6_0x5e3c3e(0x151)](_0x174acf){const _0x537882=a6_0x5e3c3e,_0x3497c0=await this[_0x537882(0x15e)][_0x537882(0x14a)]({'location':_0x174acf[_0x537882(0x108)]['location']}),_0x11ad4c=_0x3497c0[_0x537882(0x130)](_0x1c7a61=>_0x1c7a61[_0x537882(0x158)]<_0x1c7a61['roq']);return{'currentStock':_0x3497c0['map'](_0x18518e=>({'name':_0x18518e['title'],'quantity':_0x18518e['quantity']})),'lowStock':_0x11ad4c,'stockTurnoverRates':_0x3497c0['map'](_0x15396c=>({'name':_0x15396c[_0x537882(0x15c)],'turnoverRate':(_0x15396c['sold']||0x0)/(_0x15396c[_0x537882(0x158)]+(_0x15396c[_0x537882(0x139)]||0x0))}))};}async[a6_0x5e3c3e(0x161)](_0x217e62){const _0x77e8d3=a6_0x5e3c3e,_0x1049fe={'rSzDx':_0x77e8d3(0x12d),'QeGDu':'_id','yTteY':_0x77e8d3(0x134),'SZNgT':_0x77e8d3(0x126)},_0x40e70b=new Date();_0x40e70b['setHours'](0x0,0x0,0x0,0x0);const _0x3d9342=await this['saleModel'][_0x77e8d3(0x143)]([{'$match':{'transactionDate':{'$gte':_0x40e70b},'location':_0x217e62[_0x77e8d3(0x108)]['location']}},{'$unwind':'$products'},{'$group':{'_id':{'$toObjectId':_0x77e8d3(0x134)},'totalSold':{'$sum':'$products.quantity'}}},{'$sort':{'totalSold':-0x1}},{'$limit':0x5},{'$lookup':{'from':_0x1049fe[_0x77e8d3(0x15a)],'localField':'_id','foreignField':_0x1049fe[_0x77e8d3(0x129)],'as':_0x77e8d3(0x144)}},{'$unwind':'$productDetails'},{'$project':{'_id':0x0,'title':'$productDetails.title','totalSold':0x1}}]),_0x1f443e=await this[_0x77e8d3(0x165)]['aggregate']([{'$match':{'transactionDate':{'$gte':new Date(new Date()['setDate'](new Date()[_0x77e8d3(0x12f)]()-0x7))},'location':_0x217e62['user'][_0x77e8d3(0x146)]}},{'$unwind':_0x77e8d3(0x148)},{'$group':{'_id':{'$toObjectId':_0x77e8d3(0x134)},'totalSold':{'$sum':'$products.quantity'}}},{'$sort':{'totalSold':-0x1}},{'$limit':0x5},{'$lookup':{'from':_0x1049fe['rSzDx'],'localField':_0x77e8d3(0x13b),'foreignField':'_id','as':'product'}},{'$unwind':_0x77e8d3(0x126)},{'$project':{'_id':0x0,'title':'$product.title','totalSold':0x1}}]),_0x4d58eb=await this['saleModel']['aggregate']([{'$match':{'transactionDate':{'$gte':new Date(new Date()[_0x77e8d3(0x125)](new Date()['getDate']()-0x1e))},'location':_0x217e62['user']['location']}},{'$unwind':'$products'},{'$group':{'_id':{'$toObjectId':_0x1049fe[_0x77e8d3(0x16d)]},'totalSold':{'$sum':_0x77e8d3(0x110)}}},{'$sort':{'totalSold':-0x1}},{'$limit':0x5},{'$lookup':{'from':_0x1049fe['rSzDx'],'localField':_0x77e8d3(0x13b),'foreignField':_0x77e8d3(0x13b),'as':_0x77e8d3(0x171)}},{'$unwind':_0x1049fe[_0x77e8d3(0x11e)]},{'$project':{'_id':0x0,'title':_0x77e8d3(0x155),'totalSold':0x1}}]);return{'topSellingToday':_0x3d9342,'topSellingWeekly':_0x1f443e,'topSellingMonthly':_0x4d58eb};}async[a6_0x5e3c3e(0x140)](_0x131cc2,_0x1cda09){const _0x576162=a6_0x5e3c3e,_0x43c2ac=new Date(_0x131cc2['startDate']);_0x43c2ac[_0x576162(0x124)](0x0,0x0,0x0,0x0);const _0x5d6426=new Date(_0x131cc2[_0x576162(0x16c)]);_0x5d6426['setHours'](0x17,0x3b,0x3b,0x3e7);const _0x33996f=await this['saleModel']['aggregate']([{'$match':{'transactionDate':{'$gte':_0x43c2ac,'$lte':_0x5d6426},'location':_0x1cda09['user']['location']}},{'$group':{'_id':null,'totalRevenue':{'$sum':_0x576162(0x172)}}}]),_0xc8ff48=_0x33996f[0x0]?.['totalRevenue']||0x0,_0x3b829e=await this['expenseModel'][_0x576162(0x143)]([{'$match':{'createdAt':{'$gte':_0x43c2ac,'$lte':_0x5d6426},'location':_0x1cda09[_0x576162(0x108)][_0x576162(0x146)]}},{'$group':{'_id':null,'totalExpenses':{'$sum':'$amount'}}}]),_0x1125bc=_0x3b829e[0x0]?.[_0x576162(0x157)]||0x0,_0x195362=_0xc8ff48-_0x1125bc;return{'totalRevenue':_0xc8ff48,'totalExpenses':_0x1125bc,'profitOrLoss':_0x195362};}async['getProductStatistics'](_0x450062){const _0x418286=a6_0x5e3c3e,_0x24d066={'TOFze':_0x418286(0x107),'cRbcL':'$totalValue.totalValue','blMGv':_0x418286(0x164)},_0x2722e4=await this[_0x418286(0x15e)][_0x418286(0x143)]([{'$match':{'isAvailable':!![],'location':_0x450062[_0x418286(0x108)][_0x418286(0x146)]}},{'$facet':{'totalProducts':[{'$count':_0x418286(0x114)}],'totalQuantity':[{'$group':{'_id':null,'totalQuantity':{'$sum':'$quantity'}}}],'totalValue':[{'$group':{'_id':null,'totalValue':{'$sum':{'$multiply':[_0x24d066['TOFze'],'$price']}}}}],'lowStockCount':[{'$match':{'$expr':{'$lt':[_0x418286(0x107),_0x418286(0x118)]}}},{'$count':'count'}],'fastestMovingProduct':[{'$sort':{'sold':-0x1}},{'$limit':0x1},{'$project':{'_id':0x1,'title':0x1}}],'slowestMovingProduct':[{'$sort':{'sold':0x1}},{'$limit':0x1},{'$project':{'_id':0x1,'title':0x1}}],'expiredProducts':[{'$match':{'expiryDate':{'$lt':new Date()}}},{'$count':'count'}]}},{'$project':{'totalProducts':{'$arrayElemAt':['$totalProducts.count',0x0]},'totalQuantity':{'$arrayElemAt':[_0x418286(0x15b),0x0]},'totalValue':{'$arrayElemAt':[_0x24d066[_0x418286(0x131)],0x0]},'lowStockCount':{'$arrayElemAt':[_0x24d066[_0x418286(0x169)],0x0]},'fastestMovingProduct':{'$arrayElemAt':['$fastestMovingProduct',0x0]},'slowestMovingProduct':{'$arrayElemAt':['$slowestMovingProduct',0x0]},'expiredProducts':{'$arrayElemAt':[_0x418286(0x119),0x0]}}}]);return _0x2722e4[0x0];}async['getCustomerStatistics'](_0x2e17f6){const _0x11ab87=a6_0x5e3c3e,_0x3539f0={'kfiwU':'orderDetails','NYuuC':'$lastPurchase.transactionDate','IAhmh':_0x11ab87(0x13f),'PpbiQ':_0x11ab87(0x156)},_0x1e3f36=await this[_0x11ab87(0x173)][_0x11ab87(0x143)]([{'$match':{'location':_0x2e17f6['user']['location']}},{'$lookup':{'from':_0x11ab87(0x167),'localField':_0x11ab87(0x120),'foreignField':'_id','as':_0x3539f0['kfiwU']}},{'$lookup':{'from':'sales','localField':_0x11ab87(0x137),'foreignField':'_id','as':_0x11ab87(0x11c)}},{'$addFields':{'lastPurchase':{'$arrayElemAt':[{'$slice':['$orderDetails',-0x1]},0x0]},'orderCount':{'$size':'$orders'}}},{'$facet':{'newestCustomers':[{'$sort':{'createdAt':-0x1}},{'$limit':0x4},{'$project':{'_id':0x1,'name':0x1,'lastPurchaseDate':_0x3539f0['NYuuC'],'lastPurchaseAmount':_0x11ab87(0x10f),'total_spent':0x1}}],'mostFrequentCustomer':[{'$sort':{'orderCount':-0x1}},{'$limit':0x4},{'$project':{'_id':0x1,'name':0x1,'lastPurchaseDate':'$lastPurchase.transactionDate','lastPurchaseAmount':_0x11ab87(0x10f),'total_spent':0x1}}],'totalCustomers':[{'$count':_0x3539f0['IAhmh']}],'retentionCurrentMonth':[{'$match':{'lastPurchase.transactionDate':{'$gte':new Date(new Date()[_0x11ab87(0x125)](0x1)),'$lt':new Date()}}},{'$count':_0x3539f0[_0x11ab87(0x141)]}]}}]);return _0x1e3f36[0x0];}async[a6_0x5e3c3e(0x121)](_0xadb62e){const _0xf46bfc=a6_0x5e3c3e,_0x5b029e={'dBBoN':'$transactionDate','OfWxj':'Mon','lYLgt':'Tue','nTFcB':'Wed','vGnRQ':_0xf46bfc(0x16a)},_0x52d9a7=new Date();_0x52d9a7[_0xf46bfc(0x125)](_0x52d9a7[_0xf46bfc(0x12f)]()-_0x52d9a7['getDay']()),_0x52d9a7['setHours'](0x0,0x0,0x0,0x0);const _0x1b42aa=new Date(_0x52d9a7);_0x1b42aa['setDate'](_0x1b42aa['getDate']()+0x6),_0x1b42aa['setHours'](0x17,0x3b,0x3b,0x3e7);const _0x2fd37d=await this['saleModel']['aggregate']([{'$match':{'transactionDate':{'$gte':_0x52d9a7,'$lte':_0x1b42aa},'location':_0xadb62e['user'][_0xf46bfc(0x146)]}},{'$group':{'_id':{'$dateToString':{'format':'%Y-%m-%d','date':_0x5b029e[_0xf46bfc(0x170)]}},'totalSales':{'$sum':'$totalAmount'}}},{'$sort':{'_id':0x1}}]),_0x822cbf=await this[_0xf46bfc(0x128)]['aggregate']([{'$match':{'createdAt':{'$gte':_0x52d9a7,'$lte':_0x1b42aa},'location':_0xadb62e['user']['location']}},{'$group':{'_id':{'$dateToString':{'format':'%Y-%m-%d','date':_0xf46bfc(0x11f)}},'totalExpenses':{'$sum':_0xf46bfc(0x13e)}}},{'$sort':{'_id':0x1}}]),_0x22029f=[_0xf46bfc(0x145),_0x5b029e[_0xf46bfc(0x133)],_0x5b029e['lYLgt'],_0x5b029e['nTFcB'],_0x5b029e[_0xf46bfc(0x163)],_0xf46bfc(0x116),_0xf46bfc(0x136)],_0x307002=new Map(_0x822cbf[_0xf46bfc(0x16f)](_0x5e2c97=>[_0x5e2c97[_0xf46bfc(0x13b)],_0x5e2c97['totalExpenses']])),_0x58d26c=new Set([..._0x2fd37d[_0xf46bfc(0x16f)](_0x131ae3=>_0x131ae3[_0xf46bfc(0x13b)]),..._0x822cbf['map'](_0xa237=>_0xa237[_0xf46bfc(0x13b)])]),_0x57aee7=Array['from'](_0x58d26c)[_0xf46bfc(0x16f)](_0x18ead1=>{const _0x342ef0=_0xf46bfc,_0x480ad7=_0x2fd37d[_0x342ef0(0x14a)](_0x1e685e=>_0x1e685e['_id']===_0x18ead1)||{'totalSales':0x0},_0x38b19d=_0x822cbf[_0x342ef0(0x14a)](_0x40f89d=>_0x40f89d[_0x342ef0(0x13b)]===_0x18ead1)||{'totalExpenses':0x0},_0x100b01=_0x22029f[new Date(_0x18ead1)['getDay']()];return{'date':_0x18ead1,'totalSales':_0x480ad7['totalSales'],'expenses':_0x38b19d['totalExpenses'],'day':_0x100b01};});return _0x57aee7[_0xf46bfc(0x113)]((_0x3b64e6,_0x1c52ca)=>new Date(_0x3b64e6[_0xf46bfc(0x111)])['getTime']()-new Date(_0x1c52ca['date'])['getTime']());}async[a6_0x5e3c3e(0x168)](_0x50c8d1,_0xa104fb){const _0x226d78=a6_0x5e3c3e,_0x321be2={'CbzLY':_0x226d78(0x150),'XyZIJ':_0x226d78(0x152),'lVbCi':function(_0x367633,_0x586ba9){return _0x367633+_0x586ba9;},'EamPr':'day','VdbCp':function(_0x2902fa,_0x495f61){return _0x2902fa-_0x495f61;},'EExPS':function(_0x41649e,_0xac8345){return _0x41649e-_0xac8345;},'AfKux':'This\x20Year'},_0x3c045d=new Date();let _0x52353d,_0x1707f6,_0x5d41bf;switch(_0x50c8d1){case'Today':_0x52353d=new Date(_0x3c045d['setHours'](0x0,0x0,0x0,0x0)),_0x1707f6=new Date(_0x3c045d[_0x226d78(0x124)](0x17,0x3b,0x3b,0x3e7)),_0x5d41bf={'for':{'$add':[{'$divide':[{'$subtract':[{'$hour':_0x321be2['CbzLY']},{'$mod':[{'$hour':'$transactionDate'},0x2]}]},0x2]},0x1]}};break;case _0x321be2[_0x226d78(0x14b)]:_0x52353d=new Date(_0x3c045d['setDate'](_0x3c045d[_0x226d78(0x12f)]()-_0x3c045d[_0x226d78(0x15f)]())),_0x1707f6=new Date(_0x3c045d['setDate'](_0x321be2['lVbCi'](_0x3c045d['getDate']()-_0x3c045d[_0x226d78(0x15f)](),0x6))),_0x5d41bf={'for':{'$dayOfWeek':_0x226d78(0x150)}};break;case'Last\x207\x20Days':_0x52353d=new Date(),_0x52353d['setDate'](_0x52353d[_0x226d78(0x12f)]()-0x6),_0x52353d['setHours'](0x0,0x0,0x0,0x0),_0x1707f6=new Date(),_0x1707f6['setHours'](0x17,0x3b,0x3b,0x3e7),_0x5d41bf={'for':{'$subtract':[{'$add':[{'$dateDiff':{'startDate':_0x52353d,'endDate':'$transactionDate','unit':_0x321be2['EamPr']}},0x1]},0x1]}};break;case _0x226d78(0x10b):_0x52353d=new Date(_0x3c045d['setDate'](_0x321be2[_0x226d78(0x12b)](_0x3c045d['getDate']()-_0x3c045d[_0x226d78(0x15f)](),0x7))),_0x1707f6=new Date(_0x3c045d[_0x226d78(0x125)](_0x321be2[_0x226d78(0x15d)](_0x3c045d[_0x226d78(0x12f)]()-_0x3c045d[_0x226d78(0x15f)](),0x1))),_0x5d41bf={'for':{'$dayOfWeek':_0x321be2['CbzLY']}};break;case _0x226d78(0x149):_0x52353d=new Date(_0x3c045d['getFullYear'](),_0x3c045d['getMonth'](),0x1),_0x1707f6=new Date(_0x3c045d['getFullYear'](),_0x3c045d['getMonth']()+0x1,0x0),_0x5d41bf={'for':{'$dayOfMonth':'$transactionDate'}};break;case'Last\x20Month':_0x52353d=new Date(_0x3c045d['getFullYear'](),_0x3c045d['getMonth']()-0x1,0x1),_0x1707f6=new Date(_0x3c045d[_0x226d78(0x12a)](),_0x3c045d['getMonth'](),0x0),_0x5d41bf={'for':{'$dayOfMonth':_0x321be2[_0x226d78(0x14e)]}};break;case _0x226d78(0x159):_0x52353d=new Date(_0x3c045d[_0x226d78(0x12a)](),0x0,0x1),_0x1707f6=new Date(_0x3c045d[_0x226d78(0x12a)](),0x3,0x0),_0x5d41bf={'for':{'$month':_0x321be2['CbzLY']}};break;case'Second\x20Quarter':_0x52353d=new Date(_0x3c045d[_0x226d78(0x12a)](),0x3,0x1),_0x1707f6=new Date(_0x3c045d['getFullYear'](),0x6,0x0),_0x5d41bf={'for':{'$month':_0x321be2['CbzLY']}};break;case _0x226d78(0x11a):_0x52353d=new Date(_0x3c045d['getFullYear'](),0x6,0x1),_0x1707f6=new Date(_0x3c045d['getFullYear'](),0x9,0x0),_0x5d41bf={'for':{'$month':'$transactionDate'}};break;case'Fourth\x20Quarter':_0x52353d=new Date(_0x3c045d[_0x226d78(0x12a)](),0x9,0x1),_0x1707f6=new Date(_0x3c045d['getFullYear'](),0xc,0x0),_0x5d41bf={'for':{'$month':'$transactionDate'}};break;case _0x321be2['AfKux']:_0x52353d=new Date(_0x3c045d['getFullYear'](),0x0,0x1),_0x1707f6=new Date(_0x3c045d[_0x226d78(0x12a)](),0xb,0x1f),_0x5d41bf={'for':{'$month':_0x226d78(0x150)}};break;default:throw new Error(_0x226d78(0x11b));}const _0x449e5f=await this[_0x226d78(0x165)][_0x226d78(0x143)]([{'$match':{'transactionDate':{'$gte':_0x52353d,'$lte':_0x1707f6},'location':_0xa104fb['user']['location']}},{'$group':{'_id':_0x5d41bf,'totalSales':{'$sum':_0x226d78(0x172)}}},{'$sort':{'_id':0x1}},{'$project':{'_id':0x0,'for':'$_id.for','totalSales':0x1}}]);return _0x449e5f;}};exports['AnalyticsService']=AnalyticsService,exports[a6_0x5e3c3e(0x138)]=AnalyticsService=__decorate([(0x0,common_1[a6_0x5e3c3e(0x11d)])(),__param(0x0,(0x0,mongoose_1[a6_0x5e3c3e(0x12c)])(sales_schema_1['Sale'][a6_0x5e3c3e(0x160)])),__param(0x1,(0x0,mongoose_1[a6_0x5e3c3e(0x12c)])(product_schema_1['Product'][a6_0x5e3c3e(0x160)])),__param(0x2,(0x0,mongoose_1['InjectModel'])(expenses_schema_1[a6_0x5e3c3e(0x112)]['name'])),__param(0x3,(0x0,mongoose_1[a6_0x5e3c3e(0x12c)])(customer_schema_1['Customer']['name'])),__metadata('design:paramtypes',[mongoose_2['Model'],mongoose_2[a6_0x5e3c3e(0x14d)],mongoose_2['Model'],mongoose_2[a6_0x5e3c3e(0x14d)]])],AnalyticsService);