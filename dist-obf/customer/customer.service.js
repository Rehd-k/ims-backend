'use strict';const a34_0x487a32=a34_0x5eb9;(function(_0x48c2f2,_0x2c15c8){const _0x3267da=a34_0x5eb9,_0x3b376b=_0x48c2f2();while(!![]){try{const _0x137ed5=-parseInt(_0x3267da(0x120))/0x1*(-parseInt(_0x3267da(0x156))/0x2)+-parseInt(_0x3267da(0x121))/0x3*(-parseInt(_0x3267da(0x158))/0x4)+parseInt(_0x3267da(0x11e))/0x5+-parseInt(_0x3267da(0x15b))/0x6+-parseInt(_0x3267da(0x128))/0x7+-parseInt(_0x3267da(0x13a))/0x8*(-parseInt(_0x3267da(0x155))/0x9)+-parseInt(_0x3267da(0x12a))/0xa;if(_0x137ed5===_0x2c15c8)break;else _0x3b376b['push'](_0x3b376b['shift']());}catch(_0x4a7926){_0x3b376b['push'](_0x3b376b['shift']());}}}(a34_0xb62d,0x5f294));function a34_0x5eb9(_0xea9f0,_0x1d2903){const _0xb62d90=a34_0xb62d();return a34_0x5eb9=function(_0x5eb9d7,_0x203980){_0x5eb9d7=_0x5eb9d7-0x11c;let _0x2eb85f=_0xb62d90[_0x5eb9d7];return _0x2eb85f;},a34_0x5eb9(_0xea9f0,_0x1d2903);}function a34_0xb62d(){const _0x6a6773=['select','console','email','skip','findById','353585SJObHG','save','91985oBowBO','6gqQqxP','error\x20updating\x20customers\x20','@nestjs/mongoose','total_spent','__decorate','orders.returns','returns','2463503LPGJvh','error','1213680PvRWCP','populate','mongoose','Model','hasOwnProperty','log','Email\x20Already\x20Exists','$or','limit','__esModule','Customer\x20not\x20found','Error\x20returning\x20an\x20order:\x20','getOwnPropertyDescriptor','decrease','push','object','8wSZqzp','design:paramtypes','Error\x20create\x20new\x20\x20\x20cusomter:\x20','Injectable','increase','error\x20deleting\x20customers\x20','customerModel','function','parse','getAllCustomers','__param','__metadata','defineProperty','nameOrPhonenumber','addReturns','user','BadRequestException','deleteCustomer','../do_logger','decorate','ERROR','exec','sort','length','initiator','CustomerService','Error\x20getting\x20all\x20\x20\x20cusomter:\x20','6753447OkKyqo','10eiiXqP','InjectModel','443264qwGzVl','name','Error\x20creating\x20order:\x20','3837480wkAlci'];a34_0xb62d=function(){return _0x6a6773;};return a34_0xb62d();}var __decorate=this&&this[a34_0x487a32(0x125)]||function(_0x384578,_0x665140,_0x44ca97,_0x3f92bc){const _0x564c7a=a34_0x487a32;var _0x24482d=arguments[_0x564c7a(0x151)],_0x5c5ab8=_0x24482d<0x3?_0x665140:_0x3f92bc===null?_0x3f92bc=Object[_0x564c7a(0x136)](_0x665140,_0x44ca97):_0x3f92bc,_0x5d7d63;if(typeof Reflect===_0x564c7a(0x139)&&typeof Reflect[_0x564c7a(0x14d)]===_0x564c7a(0x141))_0x5c5ab8=Reflect['decorate'](_0x384578,_0x665140,_0x44ca97,_0x3f92bc);else{for(var _0x564230=_0x384578[_0x564c7a(0x151)]-0x1;_0x564230>=0x0;_0x564230--)if(_0x5d7d63=_0x384578[_0x564230])_0x5c5ab8=(_0x24482d<0x3?_0x5d7d63(_0x5c5ab8):_0x24482d>0x3?_0x5d7d63(_0x665140,_0x44ca97,_0x5c5ab8):_0x5d7d63(_0x665140,_0x44ca97))||_0x5c5ab8;}return _0x24482d>0x3&&_0x5c5ab8&&Object[_0x564c7a(0x146)](_0x665140,_0x44ca97,_0x5c5ab8),_0x5c5ab8;},__metadata=this&&this[a34_0x487a32(0x145)]||function(_0x50b4b2,_0x1b4378){const _0x6fca20=a34_0x487a32;if(typeof Reflect===_0x6fca20(0x139)&&typeof Reflect['metadata']===_0x6fca20(0x141))return Reflect['metadata'](_0x50b4b2,_0x1b4378);},__param=this&&this[a34_0x487a32(0x144)]||function(_0x53c846,_0x3cba01){return function(_0x560ff4,_0x5b4879){_0x3cba01(_0x560ff4,_0x5b4879,_0x53c846);};};Object[a34_0x487a32(0x146)](exports,a34_0x487a32(0x133),{'value':!![]}),exports[a34_0x487a32(0x153)]=void 0x0;const common_1=require('@nestjs/common'),mongoose_1=require(a34_0x487a32(0x123)),mongoose_2=require(a34_0x487a32(0x12c)),customer_schema_1=require('./customer.schema'),console_1=require(a34_0x487a32(0x15d)),do_logger_1=require(a34_0x487a32(0x14c));let CustomerService=class CustomerService{constructor(_0x438b36){const _0x126661=a34_0x487a32;this[_0x126661(0x140)]=_0x438b36;}async['createCustomer'](_0x2ff3f9,_0x54c6c2){const _0x57a47e=a34_0x487a32;try{const _0x14619d=new this[(_0x57a47e(0x140))](_0x2ff3f9);if(_0x14619d[_0x57a47e(0x15e)]){const _0x501cb4=await this['customerModel']['findOne']({'email':_0x14619d['email']});if(_0x501cb4)throw Error(_0x57a47e(0x130));}return _0x14619d[_0x57a47e(0x152)]=_0x54c6c2[_0x57a47e(0x149)]['username'],_0x14619d[_0x57a47e(0x11f)]();}catch(_0x2f3467){(0x0,do_logger_1[_0x57a47e(0x12f)])(_0x57a47e(0x13c)+_0x2f3467,_0x57a47e(0x14e));throw new common_1[(_0x57a47e(0x14a))](_0x2f3467);}}async[a34_0x487a32(0x143)](_0x246521,_0x49fa3a){const _0x3a6f1d=a34_0x487a32,{filter:filter='{}',sort:sort='{}',skip:skip=0x0,select:select=''}=_0x246521,_0xfea2a8=JSON[_0x3a6f1d(0x142)](filter),_0x6d6281=JSON[_0x3a6f1d(0x142)](sort);if(_0xfea2a8[_0x3a6f1d(0x147)]){const _0x2c890e=_0xfea2a8[_0x3a6f1d(0x147)];_0xfea2a8[_0x3a6f1d(0x131)]=[{'name':{'$regex':new RegExp(_0x2c890e,'i')}},{'phone_number':{'$regex':new RegExp(_0x2c890e,'i')}}],delete _0xfea2a8[_0x3a6f1d(0x147)];}try{return await this[_0x3a6f1d(0x140)]['find'](_0xfea2a8)[_0x3a6f1d(0x150)](_0x6d6281)[_0x3a6f1d(0x132)](0xa)[_0x3a6f1d(0x11c)](Number(skip))[_0x3a6f1d(0x15c)](select)[_0x3a6f1d(0x14f)]();}catch(_0x474902){(0x0,do_logger_1[_0x3a6f1d(0x12f)])(_0x3a6f1d(0x154)+_0x474902,'ERROR');throw new common_1[(_0x3a6f1d(0x14a))](_0x474902);}}async['addOrder'](_0x4a12db,_0x133041,_0x496c2d){const _0x383432=a34_0x487a32;try{const _0x192a68=await this[_0x383432(0x140)][_0x383432(0x11d)](_0x4a12db);if(!_0x192a68)throw new common_1['BadRequestException'](_0x383432(0x134));_0x192a68['orders']['push'](_0x133041),_0x192a68[_0x383432(0x124)]+=_0x496c2d,await _0x192a68[_0x383432(0x11f)]();}catch(_0x5029ec){(0x0,do_logger_1[_0x383432(0x12f)])(_0x383432(0x15a)+_0x5029ec,_0x383432(0x14e));throw new common_1[(_0x383432(0x14a))](_0x5029ec);}}async[a34_0x487a32(0x148)](_0x293bfd,_0x1a9e18){const _0x11dc49=a34_0x487a32;try{const _0x2fd006=await this[_0x11dc49(0x140)][_0x11dc49(0x11d)](_0x293bfd);if(!_0x2fd006)throw new common_1[(_0x11dc49(0x14a))](_0x11dc49(0x134));_0x2fd006[_0x11dc49(0x127)][_0x11dc49(0x138)](_0x1a9e18),await _0x2fd006[_0x11dc49(0x11f)]();}catch(_0x3c333a){(0x0,do_logger_1[_0x11dc49(0x12f)])(_0x11dc49(0x135)+_0x3c333a,_0x11dc49(0x14e));throw new common_1[(_0x11dc49(0x14a))](_0x3c333a);}}async['getCustomerDetails'](_0x277973){const _0x1e3514=a34_0x487a32;try{return this[_0x1e3514(0x140)][_0x1e3514(0x11d)](_0x277973)[_0x1e3514(0x12b)](_0x1e3514(0x126))[_0x1e3514(0x14f)]();}catch(_0x471dea){(0x0,do_logger_1[_0x1e3514(0x12f)])('Error\x20returning\x20an\x20order:\x20'+_0x471dea,_0x1e3514(0x14e));throw new common_1[(_0x1e3514(0x14a))](_0x471dea);}}async['updateCustomer'](_0x58937f,_0x2b7cba){const _0xde73d4=a34_0x487a32,_0x2338da=await this['customerModel'][_0xde73d4(0x11d)](_0x58937f);if(!_0x2338da){(0x0,do_logger_1[_0xde73d4(0x12f)])(_0xde73d4(0x134),_0xde73d4(0x14e));throw new common_1[(_0xde73d4(0x14a))](console_1[_0xde73d4(0x129)]);}try{for(const _0x5c4f5d in _0x2b7cba){if(_0x2b7cba['hasOwnProperty'](_0x5c4f5d)){if(_0x5c4f5d==='increase'||_0x5c4f5d==='decrease')for(const _0x2cf18f in _0x2b7cba[_0x5c4f5d]){if(_0x2b7cba[_0x5c4f5d][_0xde73d4(0x12e)](_0x2cf18f)){if(_0x5c4f5d===_0xde73d4(0x13e))_0x2338da[_0x2cf18f]+=_0x2b7cba[_0x5c4f5d][_0x2cf18f];else _0x5c4f5d===_0xde73d4(0x137)&&(_0x2338da[_0x2cf18f]-=_0x2b7cba[_0x5c4f5d][_0x2cf18f]);}}else _0x2338da[_0x5c4f5d]=_0x2b7cba[_0x5c4f5d];}}return _0x2338da['save']();}catch(_0x332db5){(0x0,do_logger_1[_0xde73d4(0x12f)])(_0xde73d4(0x122)+_0x332db5,_0xde73d4(0x14e));throw new common_1[(_0xde73d4(0x14a))](_0x332db5);}}async[a34_0x487a32(0x14b)](_0x1086e3){const _0x16654d=a34_0x487a32;try{return this[_0x16654d(0x140)]['findByIdAndDelete'](_0x1086e3)[_0x16654d(0x14f)]();}catch(_0x36ed23){(0x0,do_logger_1['log'])(_0x16654d(0x13f)+_0x36ed23,_0x16654d(0x14e));throw new common_1[(_0x16654d(0x14a))](_0x36ed23);}}};exports[a34_0x487a32(0x153)]=CustomerService,exports[a34_0x487a32(0x153)]=CustomerService=__decorate([(0x0,common_1[a34_0x487a32(0x13d)])(),__param(0x0,(0x0,mongoose_1[a34_0x487a32(0x157)])(customer_schema_1['Customer'][a34_0x487a32(0x159)])),__metadata(a34_0x487a32(0x13b),[mongoose_2[a34_0x487a32(0x12d)]])],CustomerService);