'use strict';const a50_0x502646=a50_0x32ae;(function(_0xd14ba5,_0x178bdd){const _0x15f92a=a50_0x32ae,_0x21b4d4=_0xd14ba5();while(!![]){try{const _0x50f98f=-parseInt(_0x15f92a(0x1d1))/0x1+-parseInt(_0x15f92a(0x1d0))/0x2*(-parseInt(_0x15f92a(0x1db))/0x3)+-parseInt(_0x15f92a(0x1d9))/0x4*(parseInt(_0x15f92a(0x1c7))/0x5)+-parseInt(_0x15f92a(0x1ed))/0x6*(-parseInt(_0x15f92a(0x1b1))/0x7)+parseInt(_0x15f92a(0x1d4))/0x8*(parseInt(_0x15f92a(0x1d3))/0x9)+-parseInt(_0x15f92a(0x1f6))/0xa*(-parseInt(_0x15f92a(0x1b7))/0xb)+-parseInt(_0x15f92a(0x1e0))/0xc;if(_0x50f98f===_0x178bdd)break;else _0x21b4d4['push'](_0x21b4d4['shift']());}catch(_0x3f50f){_0x21b4d4['push'](_0x21b4d4['shift']());}}}(a50_0x3e86,0x88a6b));function a50_0x32ae(_0x384a5a,_0x20963a){const _0x3e86fb=a50_0x3e86();return a50_0x32ae=function(_0x32ae22,_0x54f1b1){_0x32ae22=_0x32ae22-0x1a6;let _0x487566=_0x3e86fb[_0x32ae22];return _0x487566;},a50_0x32ae(_0x384a5a,_0x20963a);}function a50_0x3e86(){const _0x3fc7eb=['30wbEfYT','replace','__esModule','formatPhoneNumber','error\x20creating\x20\x20invoice\x20','Error\x20fetching\x20invoices:\x20','invoiceModel','findOneAndDelete','exec','Error\x20updating\x20invoices:\x20','object','location','sendMessage','3511767xtzOus','function','userId','length','design:paramtypes','name','2709201wuFEXG','save','$regex','InvoiceService','populate','update','create','username','skip','../do_logger','Error\x20fetching\x20one\x20invoice:\x20','Model','log','phone_number','Error\x20removing\x20one\x20invoice:\x20','Created\x20Invoice\x20for\x20user\x20with\x20id\x20','5EqFvVO','findOne','findById','$or','__decorate','setHours','InjectModel','@nestjs/mongoose','keys','54NRRAId','992412XWfDAe','logAction','1413VgGQNy','36552oTbvQJ','../activity/activity.service','decorate','startsWith','Invoice','2691476qsKLkm','select','121833bCzIOw','Error\x20updating\x20one\x20invoice:\x20','Update\x20Invoice','substring','stringify','9952560HRdnKa','logService','bank\x20customer','message','__param','Remove\x20Invoice','234','find','forEach','@c.us','defineProperty','limit','./invoice.schema','6tcDrjP','Removed\x20Invoice\x20with\x20filter\x20','Updated\x20Invoice\x20with\x20id\x20','ERROR','parse','BadRequestException','user','findAll','customer'];a50_0x3e86=function(){return _0x3fc7eb;};return a50_0x3e86();}var __decorate=this&&this[a50_0x502646(0x1cb)]||function(_0x7bd0d,_0x5641f3,_0x1ad5d9,_0x1c0bd5){const _0xd6a154=a50_0x502646;var _0x499699=arguments[_0xd6a154(0x1b4)],_0x5bc195=_0x499699<0x3?_0x5641f3:_0x1c0bd5===null?_0x1c0bd5=Object['getOwnPropertyDescriptor'](_0x5641f3,_0x1ad5d9):_0x1c0bd5,_0x48a1d0;if(typeof Reflect==='object'&&typeof Reflect[_0xd6a154(0x1d6)]===_0xd6a154(0x1b2))_0x5bc195=Reflect[_0xd6a154(0x1d6)](_0x7bd0d,_0x5641f3,_0x1ad5d9,_0x1c0bd5);else{for(var _0x2c4718=_0x7bd0d[_0xd6a154(0x1b4)]-0x1;_0x2c4718>=0x0;_0x2c4718--)if(_0x48a1d0=_0x7bd0d[_0x2c4718])_0x5bc195=(_0x499699<0x3?_0x48a1d0(_0x5bc195):_0x499699>0x3?_0x48a1d0(_0x5641f3,_0x1ad5d9,_0x5bc195):_0x48a1d0(_0x5641f3,_0x1ad5d9))||_0x5bc195;}return _0x499699>0x3&&_0x5bc195&&Object[_0xd6a154(0x1ea)](_0x5641f3,_0x1ad5d9,_0x5bc195),_0x5bc195;},__metadata=this&&this['__metadata']||function(_0x422b52,_0x10edc8){const _0x5d017b=a50_0x502646;if(typeof Reflect===_0x5d017b(0x1ae)&&typeof Reflect['metadata']===_0x5d017b(0x1b2))return Reflect['metadata'](_0x422b52,_0x10edc8);},__param=this&&this[a50_0x502646(0x1e4)]||function(_0xf4ff70,_0x461127){return function(_0x2ec22b,_0x1537c9){_0x461127(_0x2ec22b,_0x1537c9,_0xf4ff70);};};Object[a50_0x502646(0x1ea)](exports,a50_0x502646(0x1a6),{'value':!![]}),exports[a50_0x502646(0x1ba)]=void 0x0;const common_1=require('@nestjs/common'),mongoose_1=require(a50_0x502646(0x1ce)),invoice_schema_1=require(a50_0x502646(0x1ec)),mongoose_2=require('mongoose'),activity_service_1=require(a50_0x502646(0x1d5)),do_logger_1=require(a50_0x502646(0x1c0));let InvoiceService=class InvoiceService{constructor(_0x4570f2,_0x5b5518){const _0x10f154=a50_0x502646;this[_0x10f154(0x1aa)]=_0x4570f2,this['logService']=_0x5b5518;}async[a50_0x502646(0x1bd)](_0x23ec70,_0x381e8a){const _0x248f43=a50_0x502646;try{_0x23ec70['initiator']=_0x381e8a[_0x248f43(0x1f3)][_0x248f43(0x1be)],_0x23ec70[_0x248f43(0x1af)]=_0x381e8a[_0x248f43(0x1f3)][_0x248f43(0x1af)];const _0x5cdf86=await this[_0x248f43(0x1aa)][_0x248f43(0x1bd)](_0x23ec70);return this[_0x248f43(0x1e1)][_0x248f43(0x1d2)](_0x381e8a[_0x248f43(0x1f3)][_0x248f43(0x1b3)],_0x381e8a[_0x248f43(0x1f3)][_0x248f43(0x1be)],'Create\x20Invoice',_0x248f43(0x1c6)+_0x5cdf86['customer']),_0x5cdf86;}catch(_0x170b07){(0x0,do_logger_1[_0x248f43(0x1c3)])(_0x248f43(0x1a8)+_0x170b07,_0x248f43(0x1f0));throw new common_1[(_0x248f43(0x1f2))](_0x170b07);}}async[a50_0x502646(0x1f4)](_0x50fba1,_0xc8f839){const _0x509bef=a50_0x502646,{filter:filter='{}',sort:sort='{}',skip:skip=0x0,select:select='',limit:limit=0xa,startDate:_0x510472,endDate:_0xc5aa71,selectedDateField:_0x5b5c5f}=_0x50fba1,_0x9425f5=JSON['parse'](filter),_0x43bc72=JSON['parse'](sort);try{if(_0x510472&&_0xc5aa71&&_0x5b5c5f){const _0x2395e7=new Date(_0x510472);_0x2395e7[_0x509bef(0x1cc)](0x0,0x0,0x0,0x0);const _0x75a469=new Date(_0xc5aa71);_0x75a469[_0x509bef(0x1cc)](0x17,0x3b,0x3b,0x3e7),_0x9425f5[_0x5b5c5f]={'$gte':_0x2395e7,'$lte':_0x75a469};}if(_0x9425f5[_0x509bef(0x1f5)]){const _0x49525e=_0x9425f5[_0x509bef(0x1f5)];delete _0x9425f5['customer'],_0x9425f5[_0x509bef(0x1ca)]=[{'customer.name':{'$regex':_0x49525e[_0x509bef(0x1b9)],'$options':'i'}},{'customer.phone_number':{'$regex':_0x49525e[_0x509bef(0x1b9)],'$options':'i'}}];}const _0x1cc3fc=await this[_0x509bef(0x1aa)][_0x509bef(0x1e7)]({..._0x9425f5,'location':_0xc8f839['user']['location']})['sort'](_0x43bc72)[_0x509bef(0x1bf)](Number(skip))[_0x509bef(0x1eb)](Number(limit))[_0x509bef(0x1da)](select)['populate'](_0x509bef(0x1e2))[_0x509bef(0x1ac)]();return _0x1cc3fc;}catch(_0x2678a0){(0x0,do_logger_1[_0x509bef(0x1c3)])(_0x509bef(0x1a9)+_0x2678a0[_0x509bef(0x1e3)],_0x509bef(0x1f0));throw new Error('Error\x20fetching\x20invoices:\x20'+_0x2678a0[_0x509bef(0x1e3)]);}}[a50_0x502646(0x1c8)](_0x46b6f4){const _0x5ae2ec=a50_0x502646;try{return this[_0x5ae2ec(0x1aa)][_0x5ae2ec(0x1c8)](JSON['parse'](_0x46b6f4));}catch(_0x16c284){(0x0,do_logger_1[_0x5ae2ec(0x1c3)])(_0x5ae2ec(0x1c1)+_0x16c284['message'],_0x5ae2ec(0x1f0));throw new Error(_0x5ae2ec(0x1a9)+_0x16c284[_0x5ae2ec(0x1e3)]);}}async[a50_0x502646(0x1bc)](_0x36155d,_0x2996e7,_0x2f516d){const _0x28ac85=a50_0x502646,_0x26b935=await this[_0x28ac85(0x1aa)][_0x28ac85(0x1c8)](JSON[_0x28ac85(0x1f1)](_0x36155d));if(!_0x26b935)throw new Error('Invoice\x20not\x20found');Object[_0x28ac85(0x1cf)](_0x2996e7)[_0x28ac85(0x1e8)](_0x38b68e=>{_0x26b935[_0x38b68e]=_0x2996e7[_0x38b68e];});try{return await this[_0x28ac85(0x1e1)][_0x28ac85(0x1d2)](_0x2f516d[_0x28ac85(0x1f3)][_0x28ac85(0x1b3)],_0x2f516d['user'][_0x28ac85(0x1be)],_0x28ac85(0x1dd),_0x28ac85(0x1ef)+_0x36155d),_0x26b935[_0x28ac85(0x1b8)]();}catch(_0x392496){(0x0,do_logger_1['log'])(_0x28ac85(0x1dc)+_0x392496,'ERROR');throw new Error(_0x28ac85(0x1ad)+_0x392496['message']);}}async[a50_0x502646(0x1b0)](_0x46f5cb){const _0x739939=a50_0x502646,_0x1f9cf1=await this[_0x739939(0x1aa)][_0x739939(0x1c9)](_0x46f5cb)[_0x739939(0x1bb)](_0x739939(0x1f5));_0x1f9cf1[_0x739939(0x1f5)][_0x739939(0x1c4)]=this[_0x739939(0x1a7)](_0x1f9cf1[_0x739939(0x1f5)]['phone_number']);}async['remove'](_0x461e90,_0x491214){const _0x5d69cf=a50_0x502646;try{return await this[_0x5d69cf(0x1aa)][_0x5d69cf(0x1ab)](_0x461e90),await this[_0x5d69cf(0x1e1)][_0x5d69cf(0x1d2)](_0x491214[_0x5d69cf(0x1f3)][_0x5d69cf(0x1b3)],_0x491214[_0x5d69cf(0x1f3)][_0x5d69cf(0x1be)],_0x5d69cf(0x1e5),_0x5d69cf(0x1ee)+JSON[_0x5d69cf(0x1df)](_0x461e90)),!![];}catch(_0x1fda1e){(0x0,do_logger_1[_0x5d69cf(0x1c3)])(_0x5d69cf(0x1c5)+_0x1fda1e,_0x5d69cf(0x1f0));throw new Error('Error\x20removing\x20invoices:\x20'+_0x1fda1e[_0x5d69cf(0x1e3)]);}}[a50_0x502646(0x1a7)](_0x129f2d){const _0x5619dc=a50_0x502646,_0x14aaf9=_0x129f2d[_0x5619dc(0x1f7)](/\D/g,'');if(_0x14aaf9[_0x5619dc(0x1d7)]('0'))return'234'+_0x14aaf9[_0x5619dc(0x1de)](0x1)+_0x5619dc(0x1e9);else{if(_0x14aaf9['startsWith'](_0x5619dc(0x1e6)))return _0x14aaf9+_0x5619dc(0x1e9);else throw new Error('Invalid\x20Nigerian\x20phone\x20number');}}};exports['InvoiceService']=InvoiceService,exports[a50_0x502646(0x1ba)]=InvoiceService=__decorate([(0x0,common_1['Injectable'])(),__param(0x0,(0x0,mongoose_1[a50_0x502646(0x1cd)])(invoice_schema_1[a50_0x502646(0x1d8)][a50_0x502646(0x1b6)])),__metadata(a50_0x502646(0x1b5),[mongoose_2[a50_0x502646(0x1c2)],activity_service_1['ActivityService']])],InvoiceService);