'use strict';const a61_0x21059d=a61_0x548e;function a61_0x548e(_0x264e96,_0x4751d1){const _0x3ba678=a61_0x3ba6();return a61_0x548e=function(_0x548e86,_0x120782){_0x548e86=_0x548e86-0x120;let _0x4c6ac8=_0x3ba678[_0x548e86];return _0x4c6ac8;},a61_0x548e(_0x264e96,_0x4751d1);}(function(_0x4a4048,_0x5893b6){const _0xeccece=a61_0x548e,_0x438a16=_0x4a4048();while(!![]){try{const _0x3233e9=-parseInt(_0xeccece(0x136))/0x1*(-parseInt(_0xeccece(0x13e))/0x2)+parseInt(_0xeccece(0x13d))/0x3*(parseInt(_0xeccece(0x13f))/0x4)+-parseInt(_0xeccece(0x146))/0x5*(parseInt(_0xeccece(0x121))/0x6)+parseInt(_0xeccece(0x138))/0x7*(-parseInt(_0xeccece(0x12c))/0x8)+-parseInt(_0xeccece(0x135))/0x9+parseInt(_0xeccece(0x143))/0xa+parseInt(_0xeccece(0x125))/0xb;if(_0x3233e9===_0x5893b6)break;else _0x438a16['push'](_0x438a16['shift']());}catch(_0x5bffce){_0x438a16['push'](_0x438a16['shift']());}}}(a61_0x3ba6,0x3c0bc));var __decorate=this&&this[a61_0x21059d(0x14b)]||function(_0x1db136,_0x1e40c1,_0x33ed7a,_0x2fa9cf){const _0x37ad26=a61_0x21059d,_0x3ea59c={'RHeYj':function(_0x213acf,_0x14d372){return _0x213acf===_0x14d372;},'uHQmd':function(_0x42ca26,_0x28fa45){return _0x42ca26-_0x28fa45;},'QkOXr':function(_0x2336d8,_0x481385){return _0x2336d8<_0x481385;},'GtdMi':function(_0x3655ad,_0x50ebbf,_0x5f2775,_0x3a3aa1){return _0x3655ad(_0x50ebbf,_0x5f2775,_0x3a3aa1);}};var _0x475ded=arguments[_0x37ad26(0x145)],_0x222d27=_0x475ded<0x3?_0x1e40c1:_0x2fa9cf===null?_0x2fa9cf=Object['getOwnPropertyDescriptor'](_0x1e40c1,_0x33ed7a):_0x2fa9cf,_0x362bce;if(typeof Reflect===_0x37ad26(0x126)&&_0x3ea59c[_0x37ad26(0x127)](typeof Reflect[_0x37ad26(0x129)],_0x37ad26(0x140)))_0x222d27=Reflect['decorate'](_0x1db136,_0x1e40c1,_0x33ed7a,_0x2fa9cf);else{for(var _0x88de6b=_0x3ea59c['uHQmd'](_0x1db136['length'],0x1);_0x88de6b>=0x0;_0x88de6b--)if(_0x362bce=_0x1db136[_0x88de6b])_0x222d27=(_0x3ea59c['QkOXr'](_0x475ded,0x3)?_0x362bce(_0x222d27):_0x475ded>0x3?_0x3ea59c['GtdMi'](_0x362bce,_0x1e40c1,_0x33ed7a,_0x222d27):_0x362bce(_0x1e40c1,_0x33ed7a))||_0x222d27;}return _0x475ded>0x3&&_0x222d27&&Object['defineProperty'](_0x1e40c1,_0x33ed7a,_0x222d27),_0x222d27;},__metadata=this&&this['__metadata']||function(_0x3732ae,_0x4ab896){const _0x5ae8ba=a61_0x21059d,_0x18ce8d={'mReyh':function(_0x27c38b,_0x22e9e6){return _0x27c38b===_0x22e9e6;}};if(typeof Reflect===_0x5ae8ba(0x126)&&_0x18ce8d[_0x5ae8ba(0x13b)](typeof Reflect['metadata'],'function'))return Reflect[_0x5ae8ba(0x149)](_0x3732ae,_0x4ab896);},__param=this&&this['__param']||function(_0x5994f2,_0x5f2007){const _0x13b719={'hPGay':function(_0x362f24,_0x33ec9d,_0x2b2124,_0xd1d714){return _0x362f24(_0x33ec9d,_0x2b2124,_0xd1d714);}};return function(_0x40cdd0,_0x575e81){_0x13b719['hPGay'](_0x5f2007,_0x40cdd0,_0x575e81,_0x5994f2);};};Object[a61_0x21059d(0x14d)](exports,a61_0x21059d(0x137),{'value':!![]}),exports['InventoryService']=void 0x0;const common_1=require(a61_0x21059d(0x151)),mongoose_1=require('@nestjs/mongoose'),mongoose_2=require(a61_0x21059d(0x128)),notifications_service_1=require(a61_0x21059d(0x144)),purchases_service_1=require('../purchases/purchases.service'),sales_service_1=require(a61_0x21059d(0x14a));let InventoryService=class InventoryService{constructor(_0x2dee65,_0x5529c8,_0x74e495,_0x163332){const _0x5cdd20=a61_0x21059d;this[_0x5cdd20(0x141)]=_0x2dee65,this[_0x5cdd20(0x124)]=_0x5529c8,this['purchasesService']=_0x74e495,this['saleService']=_0x163332;}async[a61_0x21059d(0x139)](_0x4d36e0,_0x588c99){const _0x13214c=a61_0x21059d,_0x286e7b=await this['productModel'][_0x13214c(0x12d)](_0x4d36e0);if(!_0x286e7b)throw new common_1[(_0x13214c(0x134))](_0x13214c(0x14c));return _0x286e7b['quantity']+=_0x588c99,await _0x286e7b[_0x13214c(0x12a)]();}async[a61_0x21059d(0x12e)](_0xd8a39a,_0xd8f0fe){const _0x1b0235=a61_0x21059d,_0x425239={'orrxk':'Product\x20not\x20found'},_0x19d7eb=await this[_0x1b0235(0x141)][_0x1b0235(0x12d)](_0xd8a39a);if(!_0x19d7eb)throw new common_1['BadRequestException'](_0x425239['orrxk']);_0x19d7eb['sold']+=_0xd8f0fe,await _0x19d7eb['save']();}async[a61_0x21059d(0x147)](_0xfab056,_0x5d4aa0){const _0x2156f8=a61_0x21059d,_0x132cc5={'ClLnN':_0x2156f8(0x14c)},_0x555a41=await this['productModel']['findById'](_0xfab056);if(!_0x555a41)throw new common_1[(_0x2156f8(0x134))](_0x132cc5[_0x2156f8(0x122)]);if(_0x555a41['sold']<_0x5d4aa0)throw new common_1[(_0x2156f8(0x134))]('Somthings\x20Not\x20Right');_0x555a41[_0x2156f8(0x123)]-=_0x5d4aa0,await _0x555a41[_0x2156f8(0x12a)]();}async['deductStock'](_0x5aba62,_0x311059,_0x549112){const _0x463ffe=a61_0x21059d,_0xa9f73={'SYOMy':function(_0x5130cf,_0x3ebfc7){return _0x5130cf<_0x3ebfc7;}},_0x58c3ac=await this['productModel'][_0x463ffe(0x12d)](_0x5aba62);if(!_0x58c3ac)throw new common_1['BadRequestException'](_0x463ffe(0x14c));if(_0xa9f73['SYOMy'](_0x58c3ac['quantity'],_0x311059))throw new common_1[(_0x463ffe(0x134))](_0x463ffe(0x120));return _0x58c3ac['quantity']-=_0x311059,_0x58c3ac[_0x463ffe(0x150)]<=_0x58c3ac[_0x463ffe(0x12b)]&&await this[_0x463ffe(0x131)](_0x58c3ac,_0x549112),_0x58c3ac['save']();}async[a61_0x21059d(0x131)](_0x482eda,_0x5772d0){const _0x3c3e0e=a61_0x21059d;this[_0x3c3e0e(0x124)][_0x3c3e0e(0x133)]('LowStock','Product\x20'+_0x482eda['name']+'\x20is\x20running\x20low\x20on\x20stock.',['Admin'],_0x5772d0);}async[a61_0x21059d(0x12f)](_0x21ed31,_0x5cccaa,_0x288daa,_0xd61f18){const _0x20b846=a61_0x21059d;try{const _0x408d33=await this[_0x20b846(0x142)][_0x20b846(0x12f)](_0x21ed31);return _0x408d33[0x0];}catch(_0x48d9d1){return new common_1['InternalServerErrorException'](_0x48d9d1);}}async['h'](_0xeb5a3){}};exports[a61_0x21059d(0x148)]=InventoryService,exports['InventoryService']=InventoryService=__decorate([(0x0,common_1[a61_0x21059d(0x130)])(),__param(0x0,(0x0,mongoose_1['InjectModel'])(a61_0x21059d(0x132))),__param(0x2,(0x0,common_1[a61_0x21059d(0x152)])((0x0,common_1[a61_0x21059d(0x13c)])(()=>purchases_service_1['PurchasesService']))),__param(0x3,(0x0,common_1['Inject'])((0x0,common_1[a61_0x21059d(0x13c)])(()=>sales_service_1[a61_0x21059d(0x14f)]))),__metadata('design:paramtypes',[mongoose_2[a61_0x21059d(0x13a)],notifications_service_1['NotificationsService'],purchases_service_1[a61_0x21059d(0x14e)],sales_service_1[a61_0x21059d(0x14f)]])],InventoryService);function a61_0x3ba6(){const _0x2a2580=['2144100lZWXMm','../notifications/notifications.service','length','180885zSDAbC','deductFromSold','InventoryService','metadata','../sales/sales.service','__decorate','Product\x20not\x20found','defineProperty','PurchasesService','SalesService','quantity','@nestjs/common','Inject','Insufficient\x20stock','48OEWZWv','ClLnN','sold','notificationService','5104550RVxejV','object','RHeYj','mongoose','decorate','save','roq','242192WysbkW','findById','addToSold','getDashboardData','Injectable','notifyAdminLowStock','Product','createNotification','BadRequestException','4198932dZEmgh','26267htqPiY','__esModule','21csHZVJ','restockProduct','Model','mReyh','forwardRef','60807LpNzuI','30ypaoPK','4RVllVG','function','productModel','purchasesService'];a61_0x3ba6=function(){return _0x2a2580;};return a61_0x3ba6();}